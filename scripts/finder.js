function getClientVersion(){var a=document.getElementsByTagName("script"),b=-1;return $.each(a,function(a,c){-1!=c.src.indexOf("scripts/finder.")&&(b=c.src.split(".")[3])}),b}function AddressListController(a,b,c){"use strict";function d(a){f.showingEnglish=a}function e(){var d=c.REQUEST_CARD_KEY,e=c.REQUEST_CARD_URL,g=angular.copy(f.showingEnglish?a.address:a.irish);g.push(a.eircode);var h=JSON.stringify(g),i=CryptoJS.enc.Utf8.parse(d),j=CryptoJS.enc.Utf8.parse(d),k=CryptoJS.AES.encrypt(h,i,{keySize:16,iv:j,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});b.open(e+"?address="+encodeURIComponent(k))}var f=this;f.showEnglish=d,f.senCardRequest=e,f.showingEnglish=a.isEnglish}var app=angular.module("ELT",["ui.router","ngMessages","ELT.controllers","ELT.services","ELT.directives","ELT.filters","ui.bootstrap","ngSanitize","ELT.providers","pascalprecht.translate","ngCookies"]);app.config(["$stateProvider","$urlRouterProvider","$locationProvider","$translateProvider","$httpProvider",function(a,b,c,d,e){"use strict";b.when("","/"),b.otherwise("/404"),a.state("home",{url:"/",templateUrl:"view/search.html",controller:"SearchCtrl"}).state("result",{url:"/result",templateUrl:"view/result.html",controller:"resultCtrl"}).state("map",{url:"/map",templateUrl:"view/map.html",controller:"mapCtrl"}).state("address-options",{url:"/address-options",templateUrl:"view/options/address-options.html",controller:"addressOptionsCtrl"}).state("group-options",{url:"/group-options",templateUrl:"view/options/group-options.html",controller:"groupOptionsCtrl"}).state("multi-options",{url:"/multi-options",templateUrl:"view/options/multi-options.html",controller:"multiOptionsCtrl"}).state("multi-group-item-options",{url:"/multi-group-item-options",templateUrl:"view/options/multi-group-item-options.html",controller:"multiGroupItemOptionsCtrl"}).state("group-item-options",{url:"/group-item-options",templateUrl:"view/options/group-item-options.html",controller:"groupItemOptionsCtrl"}).state("nua",{url:"/nua",templateUrl:"view/info-pages/nua.html",controller:"noResultCtrl"}).state("incomplete",{url:"/incomplete",templateUrl:"view/info-pages/incomplete.html",controller:"noResultCtrl"}).state("no-eircode",{url:"/no-eircode",templateUrl:"view/no-eircode.html",controller:"noResultCtrl"}).state("partial",{url:"/partial",templateUrl:"view/info-pages/partial.html",controller:"partialCtrl"}).state("too-many-results",{url:"/too-many-results",templateUrl:"view/info-pages/too-many-results.html",controller:"noResultCtrl"}).state("help",{url:"/help",templateUrl:"view/help/help.html",controller:"helpCtrl"}).state("404",{url:"/404",templateUrl:"view/help/404.html",controller:"helpCtrl"}).state("500",{url:"/500",templateUrl:"view/help/500.html",controller:"helpCtrl"}).state("legal",{url:"/legal",templateUrl:"view/help/legal.html"}).state("privacy",{url:"/privacy",templateUrl:"view/help/privacy.html",controller:"helpCtrl"}).state("accessibility",{url:"/accessibility",templateUrl:"view/help/accessibility.html",controller:"helpCtrl"}),c.html5Mode(!1),d.useStaticFilesLoader({prefix:"translations/",suffix:".json"}),d.preferredLanguage("en"),d.useCookieStorage(),d.useSanitizeValueStrategy(null)}]),app.run(["$rootScope","$log","$state","$anchorScroll","$location","searchOffset","$window","$timeout","modalService","search","previousSearch","$translate",function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";a.$state=c;var m=navigator.userAgent.toLowerCase();/msie/.test(m)&&parseFloat((m.match(/.*(?:rv|ie)[\/: ](.+?)([ \);]|$)/)||[])[1])<9&&i.browserOutdatedModal(),a.$on("$viewContentLoaded",function(){window.scrollTo(0,0),angular.equals(c.current.name,"home")?f.top&&g.innerWidth<=767&&h(function(){angular.element("html,body").animate({scrollTop:angular.element(".input-group").offset().top-5},0)}):angular.element("#cookie-bar").hide(0,function(){angular.element("#cookie-bar").remove()})}),a.$on("$stateChangeStart",function(b,d,e,f,g){if(console.log(f.name," => ",d.name),ga("set","page","/"+d.name),ga("send","pageview"),!a.language&&angular.isDefined(l.use())&&(a.language=l.use()),angular.forEach(angular.element(".popover"),function(a){angular.element(a).remove()}),"result"===d.name&&""===f.name)return b.preventDefault(),void c.go("home");if("result"===d.name&&"home"===f.name)return void ga("send","event","Type","FullAddress");if(j.clickedBuildingEircode)return b.preventDefault(),j.selectedAddress=j.result.addresses[0],j.clickedBuildingEircode=!1,void c.go("result");if(-1!==["group-options","group-item-options","address-options","multi-options","multi-group-item-options"].indexOf(d.name)){if(angular.isUndefinedOrNull(j.result)||angular.isUndefinedOrNull(j.result.options)||!j.result.options.length){if(console.log("This will be silly:1"),angular.isUndefinedOrNull(k.result))return b.preventDefault(),void c.go("home");j.result=k.result[k.result.length-1],k.result.pop(),j.searchCompleted=!1}"group-item-options"!==f.name||"multi-options"!==d.name&&"group-options"!==d.name||(console.log("This will be silly:2"),j.result=k.result[k.result.length-1],k.result.pop(),j.searchCompleted=!1),"multi-group-item-options"===f.name&&"multi-options"===d.name&&(console.log("This will be silly:3"),j.result=k.result[k.result.length-1],k.result.pop(),j.searchCompleted=!1)}})}]),angular.isUndefinedOrNull=function(a){"use strict";return angular.isUndefined(a)||null===a||a==={}||0===a},angular.displayEircode=function(a){"use strict";return a?a.substring(0,3)+" "+a.substring(3,7):a};var intervalId,controllers=angular.module("ELT.controllers",[]).controller("SearchCtrl",["$scope","$log","autoAddressAPIService","search","$state","groupItems","$sanitize","cookieService","identity","previousSearch","$timeout",function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(a){console.log("window.ga('create', ",a,", 'auto');"),window.ga("create",a,"auto")}function m(a){return a=a.replace(/[|:;$%@!^"<>()+*?#}&]/g," "),"."!==a[a.length-1]&&" "!==a[a.length-1]||(a=a.slice(0,-1)),a}function n(b){ga("send","event","Search","Unmatched"),a.errorMessage=b,a.searchForm.$setPristine(),a.InvalidEircode=!0}function o(){a.errorMessage="",p()}function p(){a.InvalidEircode=!1,d.result=null,d.historic=null,d.changed=null,d.MultipleAddresses=null,d.searchQuery=null,d.selectedAddress=null,d.searchCompleted=!1,f.item=null,a.autoCompleteAddresses=[],a.loading=!1,d.rememberSearch=!1,d.optionTab=null,d.searchType=null,d.searchType2=null,d.clickedBuildingEircode=!1,j.result=[],d.ecadid=null,d.mapCenterCoords=null}function q(b,f){a.loading=!0,d.searchType2=f,c.chooseSearch(b,f).success(function(b){if(b.error)return b.error.code&&401006===b.error.code&&a.retryIdentity?void(a.restrictSearch=!0):(p(),void n(b.error.text));if(550===b.result.code&&angular.isUndefinedOrNull(b.totalOptions)||700===b.result.code)p(),n("No search results have been found.");else{d.result=b,angular.isUndefinedOrNull(b.input.__reserved)||angular.isUndefinedOrNull(b.input.__reserved.postcode)||ga("send","event","Type","Eircode");var f=c.getAddressView(d.result,!0);""!==f&&(angular.equals(f,"no-result")||angular.equals(f,"too-many-results")?angular.equals(f,"too-many-results")?(p(),n("Sorry there are too many results, please search again using more details.")):(p(),n("No search results have been found.")):angular.equals(f,"")||e.go(f))}}).error(function(){p(),n("A search error has occurred.")})}!function(){d.rememberSearch&&(a.searchQuery=d.searchQuery),a.retryIdentity=!0,i.key?a.restrictSearch=h.restrictSearches():c.getIdentity().then(function(b){if(b.data.error){if(p(),!b.data.error||401006!==b.data.error.code)return void n(b.data.error.text);a.restrictSearch=!0}i.key=b.data.key,i.count=b.data.value,console.log("window.ga('create', ",b.data.trackingId,", 'auto');"),window.ga("create",b.data.trackingId,"auto"),clearInterval(intervalId),intervalId=setInterval(function(){l(b.data.trackingId)},36e5),a.restrictSearch=h.restrictSearches()}),o()}(),a.searchEircode=function(){ga("send","event","Search","SearchButton");var b=m(a.searchQuery);d.searchQuery=b,a.searchForm.$setPristine(),c.isEircodeSearch(b)?(ga("send","event","Type","Eircode"),q(b,"eircode")):q(b,"addressSearch")},a.$watch(function(){return a.searchQuery},function(){a.InvalidEircode=!1}),a.onSelect=function(a){ga("send","event","Search","Autocomplete"),d.searchQuery=a.displayName,1e9===a.addressId?q(m(a.displayName),"addressSearch"):q(a.links[0].href,"link")},a.getAutoCompleteAddresses=function(b){var d=[];return angular.isUndefinedOrNull(b)||b.length<=3?d:(b=m(b),c.getAutoComplete(b).then(function(e){if(angular.isUndefinedOrNull(e.data.error)){if(!angular.isUndefinedOrNull(e.data.options)){d=e.data.options;var f=b;if(null===d&&(d=[]),!c.isAutoCompleteLikeEircodeSearch(b)){var g={addressId:1e9,displayName:f,unique:!1};d.unshift(g)}return d}}else a.restrictSearches=!0}))},a.locateMe=function(){o(),e.go("map")}}]);angular.module("ELT.controllers").controller("resultCtrl",["$scope","search","$state","$window","$rootScope","cookieService","modalService","$log",function(a,b,c,d,e,f,g,h){"use strict";if(angular.isUndefinedOrNull(b.result)||angular.isUndefinedOrNull(b.result.postalAddress))return void c.go("home");ga("send","event","Result","CompleteResult"),"link"==b.searchType2?ga("send","event","NewResult","AutoComplete"):"addressSearch"==b.searchType2?ga("send","event","NewResult","SearchButton"):"map"==b.searchType2?ga("send","event","NewResult","Map"):"eircode"==b.searchType2?ga("send","event","NewResult","EircodeEntered"):"Options"==b.searchType2?ga("send","event","NewResult","Options"):(ga("send","event","NewResult","Other"),$.ajax({type:"GET",dataType:"jsonp",url:"http://api.autoaddress.ie/2.0/getecaddata?key="+b.result.input.key+"&ecadId=1702105351&format=json&searchQuery="+b.searchQuery+"&otherValue="+b.searchType2,success:function(a){console.log("Logged query: "+b.searchQuery)}})),b.searchCompleted=!0,f.incrementSearchCount(),a.search=b.result,a.search.displayMap=!angular.isUndefinedOrNull(a.search.spatialInfo.etrs89);try{a.search.isenglish=!(a.search.administrativeInfo.gaeltacht||"ie"===e.language)}catch(b){a.search.isenglish=!0}a.search.historic=b.historic,a.search.changed=b.changed,a.tab=a.search.historic?2:1,a.selectTab=function(b){a.tab=b},a.isSelected=function(b){return a.tab===b},a.searchesRemaining=f.searchCountRemaining(),a.displayShareEircode=function(){g.shareEircodeModal(a.search.ecadId)},a.shareLocation=function(){ga("send","event","GetDirections","ResultsPage");var b;b=/iPhone/.test(navigator.userAgent)?"http://maps.apple.com/maps?q="+a.search.spatialInfo.etrs89.location.latitude+","+a.search.spatialInfo.etrs89.location.longitude:"https://maps.google.com/maps?f=d&daddr="+a.search.spatialInfo.etrs89.location.latitude+","+a.search.spatialInfo.etrs89.location.longitude,d.location.href=a.geoPath=b}}]).controller("noResultCtrl",["$scope","$log","search","$state",function(a,b,c,d){"use strict";!function(){ga("send","event","Result","NoResult"),angular.isUndefinedOrNull(c.result)||angular.isUndefinedOrNull(c.result.geographicAddress)?(a.hasResult=!1,a.searchQuery=c.searchQuery):(a.hasResult=!0,a.searchQuery=c.result.geographicAddress)}()}]).controller("partialCtrl",["$scope","$log","search","$state",function(a,b,c,d){"use strict";if(angular.isUndefinedOrNull(c.result)||angular.isUndefinedOrNull(c.searchQuery)||c.searchCompleted)return void d.go("home");ga("send","event","Result","PartialResult"),function(){ga("send","event","Result","PartialResult"),a.searchQuery=c.searchQuery,c.rememberSearch=!0}(),a.partialAddress=c.searchQuery}]),angular.module("ELT.controllers").controller("mapCtrl",["$state","$scope","cookieService","search","etlLocate","modalService","$timeout","$window","autoAddressAPIService","WEBSERVICE_ENDPOINTS","$translate","identity","previousSearch",function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";function n(){null!=b.bbox&&null!=b.bbox.min&&0!=b.bbox.min.latitude?x():y(b.mapZoom),A(b.defaults.ICONS.TARGET,"")}function o(){A(b.defaults.ICONS.TARGET,"")}function p(a,c){b.defaults.GPS_OPTIONS.enableHighAccuracy=a,b.recenterGPSIcon=c,navigator.geolocation?navigator.geolocation.getCurrentPosition(q,r,b.defaults.GPS_OPTIONS):window.navigator.geolocation?h.navigator.geolocation.getCurrentPosition(q,r,b.defaults.GPS_OPTIONS):r("Geolocation is not supported by this browser."),g(function(){b.gettingLocation&&r("Location detection failed for BROWSER: Timeout.")},1e4)}function q(a){b.$apply(function(){var c=b.map.getLayersByName("GPS Accuracy")[0];null==c?c=new OpenLayers.Layer.Vector("GPS Accuracy"):(c.removeAllFeatures(),c.events.unregister("moveend",c,s));var d={fillColor:"#DDDD22",fillOpacity:.3,strokeWidth:1,strokeOpacity:.6,strokeColor:"#DDDD22"},e=1==b.defaults.GPS_OPTIONS.enableHighAccuracy?2:4,f=new OpenLayers.Feature.Vector(OpenLayers.Geometry.Polygon.createRegularPolygon(new OpenLayers.Geometry.Point(a.coords.longitude,a.coords.latitude).transform("EPSG:"+b.defaults.PROJECTION_CODES.DATA_CRS,"EPSG:"+b.defaults.PROJECTION_CODES.CRS),a.coords.accuracy/e,40,0),{},d);if(c.addFeatures([f]),b.map.addLayer(c),b.addressCoords=new OpenLayers.LonLat(a.coords.longitude,a.coords.latitude).transform("EPSG:"+b.defaults.PROJECTION_CODES.DATA_CRS,"EPSG:"+b.defaults.PROJECTION_CODES.CRS),b.recenterGPSIcon)if(b.defaults.GPS_OPTIONS.enableHighAccuracy){var g=b.map.getZoomForExtent(f.geometry.bounds,!1);y(g),z(b.defaults.ICONS.MY_LOCATION,""),A(b.defaults.ICONS.TARGET,""),c.events.register("moveend",c,s),b.gettingLocation=!1,g>=b.defaults.MIN_SEARCH_ZOOM&&(b.firstMyLocationInstructionWindow&&(b.showInstructionModal=!0),b.firstMyLocationInstructionWindow=!1)}else y(b.defaults.ZOOM)})}function r(a){var c;if(b.gettingLocation){if(null!==a.message)switch(a.code){case a.PERMISSION_DENIED:case a.POSITION_UNAVAILABLE:c="We could not determine your location. Please turn on location services if not enabled and try again.";break;case a.TIMEOUT:case a.UNKNOWN_ERROR:c="We could not determine your location, the request to get your location timed out. Please try again."}else c=a;b.gettingLocation=!1,b.locationFailed=!0,b.$apply(),A(b.defaults.ICONS.TARGET,""),w(),f.mapErrorModal(c)}}function s(){var a=b.map.getLayersByName("GPS Accuracy")[0];null!=a&&b.map.removeLayer(a)}function t(){var a,b=angular.element("#map"),c=angular.element(".original"),d=550,e=h.innerHeight-200-2*angular.element(".header").height();if(e&&(a=e>=d?e:d),h.innerWidth<=767){a=h.innerHeight-(c.outerHeight()+2)}b.height(a)}function u(){t();var a={projection:"EPSG:"+b.defaults.PROJECTION_CODES.CRS,displayProjection:"EPSG:"+b.defaults.PROJECTION_CODES.DISP_CRS,units:"m",controls:[new OpenLayers.Control.TouchNavigation,new OpenLayers.Control.Zoom,new OpenLayers.Control.Navigation({wheelChange:function(a,b){var c=this.map.getZoom(),d=this.map.getZoom()+Math.round(b);d=Math.max(d,0),(d=Math.min(d,this.map.getNumZoomLevels()))!==c&&(d>c?this.map.zoomIn():this.map.zoomOut())}})]};b.map=new OpenLayers.Map("map",a),OpenLayers.Util.onImageLoadErrorColor="transparent",b.map.updateSize(),v()}function v(){var a=new OpenLayers.Layer.XYZ("Road",b.defaults.OSi.LAYERS.MAP_GENIE_ROAD+"tile/${z}/${y}/${x}?token="+b.defaults.OSi.TOKENS.MAP_GENIE_TOKEN,{isBaseLayer:!0,transitionEffect:"resize",attribution:'<a href="http://www.osi.ie/" target="_blank" >OSi</a>',sphericalMercator:!0,projection:new OpenLayers.Projection("EPSG:"+b.defaults.PROJECTION_CODES.CRS),resolutions:[156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,.5971642833948135,.29858214169740677],serverResolutions:[156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,.5971642833948135,.29858214169740677]}),c=new OpenLayers.Layer.XYZ("Aerial",b.defaults.OSi.LAYERS.MAP_GENIE_AERIAL+"tile/${z}/${y}/${x}?token="+b.defaults.OSi.TOKENS.MAP_GENIE_TOKEN,{isBaseLayer:!0,transitionEffect:"resize",attribution:'<a href="http://www.osi.ie/" target="_blank" >OSi</a>',sphericalMercator:!0,projection:new OpenLayers.Projection("EPSG:"+b.defaults.PROJECTION_CODES.CRS),resolutions:[156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,.5971642833948135,.29858214169740677],serverResolutions:[156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,.5971642833948135]});b.map.addLayers([a,c]),w();var d=new OpenLayers.Layer.XYZ("redDots",b.defaults.REDDOTS+"/${z}/${y}/${x}.png",{isBaseLayer:!1,transitionEffect:"resize",attribution:"",sphericalMercator:!0,transparent:!0,projection:new OpenLayers.Projection("EPSG:"+b.defaults.PROJECTION_CODES.CRS),maxResolution:1.194328566789627,minResolution:.29858214169740677});b.map.addLayer(d);var e=!0;a.events.register("loadend",a,function(){e&&(b.map.zoomTo(b.mapZoom),e=!1)})}function w(){if(null===b.displayAddress||null===b.buildingCoordinates){if(b.addressCoords=new OpenLayers.LonLat(b.defaults.IRL_VIEW.CENTER_LON,b.defaults.IRL_VIEW.CENTER_LAT).transform("EPSG:"+b.defaults.PROJECTION_CODES.DATA_CRS,"EPSG:"+b.defaults.PROJECTION_CODES.CRS),b.mapZoom="MyLocationMap"!=b.mapType||b.locationFailed?b.defaults.IRL_VIEW.ZOOM:b.mapZoom,"AddressSelectionMap"==b.mapType&&(null!=b.bbox&&null!=b.bbox.min&&0!=b.bbox.min.latitude||null!=b.buildingCoordinates))if(null!=b.buildingCoordinates)b.addressCoords=new OpenLayers.LonLat(b.buildingCoordinates.longitude,b.buildingCoordinates.latitude).transform("EPSG:"+b.defaults.PROJECTION_CODES.DATA_CRS,"EPSG:"+b.defaults.PROJECTION_CODES.CRS),b.mapZoom=b.defaults.ZOOM;else{var a=new OpenLayers.Bounds(b.bbox.min.longitude,b.bbox.min.latitude,b.bbox.max.longitude,b.bbox.max.latitude).transform("EPSG:"+b.defaults.PROJECTION_CODES.DATA_CRS,"EPSG:"+b.defaults.PROJECTION_CODES.CRS);b.mapZoom=b.map.getZoomForExtent(a,!1)}}else b.addressCoords=new OpenLayers.LonLat(b.buildingCoordinates.longitude,b.buildingCoordinates.latitude).transform("EPSG:"+b.defaults.PROJECTION_CODES.DATA_CRS,"EPSG:"+b.defaults.PROJECTION_CODES.CRS),b.mapZoom=b.defaults.ZOOM;null!=d.result&&"nua"==d.result.eircodeMatch&&(b.mapZoom=b.mapZoom-1),b.map.setCenter(b.addressCoords,b.mapZoom)}function x(){var a=new OpenLayers.Bounds(b.bbox.min.longitude,b.bbox.min.latitude,b.bbox.max.longitude,b.bbox.max.latitude).transform("EPSG:"+b.defaults.PROJECTION_CODES.DATA_CRS,"EPSG:"+b.defaults.PROJECTION_CODES.CRS),c=(b.map.getZoomForExtent(a,!0),a.getCenterLonLat());b.map.setCenter(c)}function y(a){b.map.setCenter(b.addressCoords,a)}function z(a,c){var d=b.map.getLayersByName("Address Result")[0];null==d?d=new OpenLayers.Layer.Vector("Address Result",{styleMap:new OpenLayers.StyleMap({externalGraphic:a.URL,graphicWidth:a.WIDTH,graphicHeight:a.HEIGHT,title:"${tooltip}"})}):d.removeAllFeatures(),d.displayInLayerSwitcher=!1;var e=new OpenLayers.Geometry.Point(b.addressCoords.lon,b.addressCoords.lat);d.addFeatures([new OpenLayers.Feature.Vector(e,{tooltip:c})]),b.map.addLayer(d)}function A(a,c){var e=b.map.getLayersByName("Center")[0];null==e?e=new OpenLayers.Layer.Vector("Center",{styleMap:new OpenLayers.StyleMap({externalGraphic:a.URL,graphicWidth:a.WIDTH,graphicHeight:a.HEIGHT,title:"${tooltip}"})}):e.removeAllFeatures(),e.displayInLayerSwitcher=!1,e.alwaysInRange=!0;var f=new OpenLayers.Geometry.Point(b.map.getCenter().lon,b.map.getCenter().lat);e.addFeatures([new OpenLayers.Feature.Vector(f,{tooltip:c})]),b.map.addLayer(e),b.map.events.register("move",e,function(a){return d.mapCenterCoords=b.map.getCenter().transform("EPSG:"+b.defaults.PROJECTION_CODES.CRS,"EPSG:"+b.defaults.PROJECTION_CODES.DATA_CRS),e.features[0].move(b.map.getCenter()),!0},!0)}d.searchType2="map",function(){if(angular.isUndefined(d.result)||angular.equals(d,{})||c.restrictSearches())return void a.go("home");if(b.getEircodeTxt=k.instant("MAP_GET_EIRCODE_BUTTON"),b.zoomingTxt=k.instant("MAP_ZOOMING_BUTTON"),b.showHelpWindow=!1,b.retryIdentity=!0,b.loading=!1,b.showInstructionModal=!1,b.firstZoomInstructionWindow=!0,b.firstMyLocationInstructionWindow=!0,b.getEircodeBtnText=b.getEircodeTxt,b.showMap=!1,b.defaults={ICONS:{LOCATION_PIN_SUCCESS:{URL:"icons/target-found-icon.png",WIDTH:36,HEIGHT:104},MY_LOCATION:{URL:"icons/find-my-location.png",WIDTH:16,HEIGHT:16},TARGET:{URL:"icons/Target-Large-inner-White-44.png",WIDTH:44,HEIGHT:44}},ZOOM:18,NOT_MATCHED_ZOOM:15,MIN_SEARCH_ZOOM:17,GPS_OPTIONS:{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e3},IRL_VIEW:{ZOOM:7,CENTER_LON:-7,CENTER_LAT:53.5},PROJECTION_CODES:{CRS:"3857",DISP_CRS:"4326",DATA_CRS:"4326"},OSi:{TOKENS:{MAP_GENIE_TOKEN:j.MAP_GENIE_TOKEN},LAYERS:{MAP_GENIE_ROAD:j.OSI_ENDPOINT+"arcgis/rest/services/WM/basemap_premium/MapServer/",MAP_GENIE_AERIAL:j.OSI_ENDPOINT+"arcgis/rest/services/WM/digitalglobe/MapServer/"}},REDDOTS:j.REDDOT_LAYER,SEARCH_RADIUS:{PIXELS:14,MIN_METERS:10}},b.map=null,b.gettingLocation=!1,b.locationFailed=!1,b.recenterGPSIcon=!1,b.displayAddress=null,b.mapZoom=b.defaults.ZOOM,angular.isUndefinedOrNull(d.result))u(),b.gettingLocation=!0,p(!1,!0),g(function(){p(!0,!0)},2e3);else if(angular.isUndefinedOrNull(d.result.spatialInfo))angular.isUndefinedOrNull(d.result.addressId)?(u(),n()):i.getECAD(d.result.addressId).success(function(a){switch(d.result=a,b.bbox=angular.isUndefinedOrNull(d.result.spatialInfo.etrs89.boundingBox)?null:d.result.spatialInfo.etrs89.boundingBox,b.buildingCoordinates=angular.isUndefinedOrNull(d.result.spatialInfo.etrs89.boundingBox)?d.result.spatialInfo.etrs89.location:null,d.MultipleAddresses?b.displayAddress=d.selectedAddress:null===d.result||null===d.result.options||angular.isUndefinedOrNull(d.result.geographicAddress)||(b.displayAddress=d.result.geographicAddress.english),null===d.result?(b.mapType="MyLocationMap",b.mapHeader="-"):angular.isUndefinedOrNull(d.result.eircodeInfo)?b.mapType="AddressSelectionMap":b.mapType="FoundAddressMap",u(),b.mapType){case"MyLocationMap":b.gettingLocation=!0,p(!1,!0),g(function(){p(!0,!0)},2e3);break;case"AddressSelectionMap":n();break;case"FoundAddressMap":o()}});else switch(b.bbox=angular.isUndefinedOrNull(d.result.spatialInfo.etrs89.boundingBox)?null:d.result.spatialInfo.etrs89.boundingBox,b.buildingCoordinates=angular.isUndefinedOrNull(d.result.spatialInfo.etrs89.boundingBox)?d.result.spatialInfo.etrs89.location:null,d.MultipleAddresses?b.displayAddress=d.selectedAddress:null===d.result||angular.isUndefinedOrNull(d.result.geographicAddress)||(b.displayAddress=d.result.geographicAddress.english),null===d.result?(b.mapType="MyLocationMap",b.mapHeader="-"):angular.isUndefinedOrNull(d.result.eircodeInfo)?b.mapType="AddressSelectionMap":b.mapType="FoundAddressMap",u(),b.mapType){case"MyLocationMap":b.gettingLocation=!0,p(!1,!0),g(function(){p(!0,!0)},2e3);break;case"AddressSelectionMap":n();break;case"FoundAddressMap":o()}}(),b.isFoundAddressMap=function(){return b.gettingLocation?b.mapHeader="Getting location":b.mapHeader="Move the map so the target is over the building marker and click Get Eircode.","FoundAddressMap"===b.mapType},b.isLocateMeMap=function(){return"MyLocationMap"===b.mapType},b.foundLocation=function(){return!b.gettingLocation&&!b.locationFailed},b.isLoading=function(){return b.gettingLocation},b.tryGetEircode=function(){b.map.zoom<b.defaults.MIN_SEARCH_ZOOM?(b.loading=!0,b.getEircodeBtnText=b.zoomingTxt,b.map.zoomTo(b.defaults.MIN_SEARCH_ZOOM),g(function(){b.getEircodeBtnText=b.getEircodeTxt,b.loading=!1,b.firstZoomInstructionWindow&&(b.showInstructionModal=!0),b.firstZoomInstructionWindow=!1},500)):b.getEircode()},b.getEircode=function(){b.loading=!0,b.mapMessage="";var a=b.map.getPixelFromLonLat(b.map.getCenter()),c=b.defaults.SEARCH_RADIUS.PIXELS,d=b.map.getLonLatFromPixel(new OpenLayers.Pixel(a.x+c,a.y)),g=new OpenLayers.Geometry.LineString([new OpenLayers.Geometry.Point(b.map.getCenter().lon,b.map.getCenter().lat),new OpenLayers.Geometry.Point(d.lon,d.lat)]),h=g.getLength(),j=h,k=b.map.getCenter().transform("EPSG:"+b.defaults.PROJECTION_CODES.CRS,"EPSG:"+b.defaults.PROJECTION_CODES.DATA_CRS);e.getEircode(k.lat,k.lon,j).success(function(a){if(a.error){if(!a.error.code||401!==a.error.code||!b.retryIdentity)return b.loading=!1,void f.noEircodeFoundModal();i.getIdentity().then(function(a){b.retryIdentity=!1,l.key=a.data.key,l.count=a.data.value,console.log("window.ga('create', ",a.data.trackingId,", 'auto');"),window.ga("create",a.data.trackingId,"auto"),b.getEircode()})}else b.retryIdentity=!0,b.loading=!1,angular.isUndefined(a.hits)||1===a.hits.length&&f.showEircodeModal(a)}).error(function(){b.loading=!1,f.noEircodeFoundModal()})},b.restartMap=function(){"AddressSelectionMap"==b.mapType?null!=b.bbox&&null!=b.bbox.min&&0!=b.bbox.min.latitude?x():y(b.defaults.NOT_MATCHED_ZOOM):b.reloadMyLocation()},b.showHelp=function(){b.showHelpWindow=!0},b.showInfoWindow=function(){return b.showInstructionModal||b.showHelpWindow},b.closeInfoWindow=function(){g(function(){b.showInstructionModal=!1,b.showHelpWindow=!1})},b.reloadMyLocation=function(){b.gettingLocation=!0,p(!0,!0)},b.switchBaseLayer=function(a){b.showMap="Road"!==a;b.map.getLayersByName("Hybrid Transport")[0];if("Hybrid"!==a){var c=b.map.getLayersByName(a)[0];b.map.setBaseLayer(c),b.map.baseLayer.setVisibility(!0)}else b.switchBaseLayer("Aerial")},angular.element(h).bind("resize",function(){t(),b.map&&b.map.updateSize()})}]).controller("showEircodeCtrl",["search","$scope","$log","$modalInstance","$state","result","autoAddressAPIService",function(a,b,c,d,e,f,g){"use strict";!function(){b.address=f.hits[0].postalAddress}(),b.cancel=function(){d.dismiss("cancel")},b.confirm=function(){d.dismiss("cancel"),ga("send","event","Search","Map"),g.searchNext(f.hits[0].links[0].href),ga("send","event","NewResult","MapClick")}}]),function(){"use strict";function a(a,b,c,d,e){function f(){angular.element("#resultMap").height(300);var a={projection:"EPSG:"+b.defaults.PROJECTION_CODES.CRS,displayProjection:"EPSG:"+b.defaults.PROJECTION_CODES.DISP_CRS,units:"m",controls:[]};b.map=new OpenLayers.Map("resultMap",a),g()}function g(){var a=new OpenLayers.Layer.XYZ("Road",b.defaults.OSi.LAYERS.MAP_GENIE_ROAD+"tile/${z}/${y}/${x}?token="+b.defaults.OSi.TOKENS.MAP_GENIE_TOKEN,{isBaseLayer:!0,transitionEffect:"resize",attribution:'<a href="http://www.osi.ie/" target="_blank" >OSi</a>',sphericalMercator:!0,projection:new OpenLayers.Projection("EPSG:"+b.defaults.PROJECTION_CODES.CRS),resolutions:[156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,.5971642833948135,.29858214169740677,.1492910708487034],serverResolutions:[156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,.5971642833948135,.29858214169740677]});b.map.addLayers([a]);var c=!0;a.events.register("loadend",a,function(){c&&(b.map.zoomTo(b.mapZoom),c=!1)})}function h(){b.addressCoords=new OpenLayers.LonLat(b.displayAddress.spatialInfo.etrs89.location.longitude,b.displayAddress.spatialInfo.etrs89.location.latitude).transform("EPSG:"+b.defaults.PROJECTION_CODES.DISP_CRS,"EPSG:"+b.defaults.PROJECTION_CODES.CRS),b.mapZoom=b.defaults.ZOOM,b.map.setCenter(b.addressCoords,b.mapZoom)}function i(a,c){var d=b.map.getLayersByName("Address Result")[0];null==d?d=new OpenLayers.Layer.Vector("Address Result",{styleMap:new OpenLayers.StyleMap({externalGraphic:a.URL,graphicWidth:a.WIDTH,graphicHeight:a.HEIGHT,title:"${tooltip}"})}):d.removeAllFeatures(),d.displayInLayerSwitcher=!1;var e=new OpenLayers.Geometry.Point(b.addressCoords.lon,b.addressCoords.lat);d.addFeatures([new OpenLayers.Feature.Vector(e,{tooltip:c})]),b.map.addLayer(d)}if(angular.isUndefinedOrNull(d.result)||angular.isUndefinedOrNull(d.result))return void a.go("home");if(b.displayMap=!0,b.defaults={ICONS:{LOCATION_PIN_SUCCESS:{URL:"icons/target-found-icon.png",WIDTH:36,HEIGHT:104}},ZOOM:window.innerWidth<=767?17:18,PROJECTION_CODES:{CRS:"3857",DISP_CRS:"4326"},OSi:{TOKENS:{MAP_GENIE_TOKEN:e.MAP_GENIE_TOKEN},LAYERS:{MAP_GENIE_ROAD:e.OSI_ENDPOINT+"arcgis/rest/services/WM/basemap_premium/MapServer/"}}},b.map=null,b.mapZoom=b.defaults.ZOOM,b.bbox=null!==d.result?d.result.boundingBox:null,null!==d.result)try{null!==d.result.postalAddress.english&&(b.displayAddress=d.result,b.mapType="FoundAddressMap")}catch(a){b.displayAddress=d.result}b.search.displayMap?(b.displayMap=!0,f(),h(),i(b.defaults.ICONS.LOCATION_PIN_SUCCESS,null!==b.displayAddress?"Eircode: "+angular.displayEircode(b.displayAddress.eircodeInfo.eircode):"No Eircode")):(b.displayMap=!1,angular.element(".search-result-map").hide()),b.moveMap=function(){a.go("map")}}angular.module("ELT.controllers").controller("resultMapCtrl",a),a.$inject=["$state","$scope","$log","search","WEBSERVICE_ENDPOINTS"]}(),angular.module("ELT.controllers").controller("helpCtrl",["$location","$scope","$log","$rootScope",function(a,b,c,d){"use strict";!function(){angular.element(".modal-content > .ng-scope").each(function(){try{angular.element(this).scope().$dismiss()}catch(a){}})}()}]).controller("headerCtrl",["$location","$scope","$log","$modal",function(a,b,c,d){"use strict"}]).controller("languageCtrl",["$location","$scope","$log","$translate","$rootScope",function(a,b,c,d,e){"use strict";!function(){b.language=d.use()}(),b.setLanguage=function(a){b.language=a,d.use(a),e.language=a}}]).controller("shareEircodeCtrl",["$location","$scope","$log","$sanitize","$modalInstance","$state","search","autoAddressAPIService","result_id",function(a,b,c,d,e,f,g,h,i){"use strict";!function(){b.ok=function(){e.close(b.selected.item)},b.isCollapsed=!1,b.message_sent=!1,b.errorMessage="",b.loading=!1}(),b.cancel=function(){e.dismiss("cancel")},b.close=function(){e.close("cancel")},b.shareEircode=function(a){b.loading=!0,a.ecad_id=i,h.shareEircode(a).success(function(){b.shareForm.$setPristine(),b.isCollapsed=!0,b.message_sent=!0,b.submission=null,b.errorMessage="",b.loading=!1}).error(function(){b.errorMessage="Error has occurred, please try again later.",b.loading=!1})}}]).controller("supportInstanceCtrl",["$timeout","$translate","$location","$scope","$log","$sanitize","$modalInstance","$state","search","autoAddressAPIService",function(a,b,c,d,e,f,g,h,i,j){"use strict";!function(){d.submission={},d.submission.issue=null,d.options=[],b("SUPPORT_FORM_ISSUE_SELECT").then(function(a){d.select_default=a}),b("SUPPORT_FORM_ISSUE_SELECT_1").then(function(a){d.select_issue_1=a}),b("SUPPORT_FORM_ISSUE_SELECT_2").then(function(a){d.select_issue_2=a}),b("SUPPORT_FORM_ISSUE_SELECT_3").then(function(a){d.select_issue_3=a}),b("SUPPORT_FORM_ISSUE_SELECT_4").then(function(a){d.select_issue_4=a}),b("SUPPORT_FORM_ISSUE_SELECT_5").then(function(b){d.select_issue_5=b,d.options=[{text:d.select_issue_1,value:d.select_issue_1},{text:d.select_issue_2,value:d.select_issue_2},{text:d.select_issue_3,value:d.select_issue_3},{text:d.select_issue_4,value:d.select_issue_4},{text:d.select_issue_5,value:d.select_issue_5}],a(function(){angular.element("select").each(function(a,b){b.options[b.selectedIndex].text+=" "})},!1)}),d.ok=function(){g.close(d.selected.item)},d.fixIE=function(){for(var a=document.querySelectorAll("select"),b=0;b<a.length;b++)a[b].parentNode.insertBefore(a[b],a[b])},d.isCollapsed=!1,d.message_sent=!1,d.errorMessage="",d.loading=!1}(),d.cancel=function(){g.dismiss("cancel")},d.close=function(){g.close("cancel")},d.help=function(){g.close("cancel"),h.go("help")},d.submitSupport=function(a){d.loading=!0,j.submitIssue(a,i).success(function(a){d.submitForm.$setPristine(),d.isCollapsed=!0,d.message_sent=!0,d.submission=null,d.errorMessage="",d.loading=!1}).error(function(){d.submitForm.$setPristine(),d.isCollapsed=!0,d.message_sent=!0,d.submission=null,d.errorMessage="",d.loading=!1})},d.interacted=function(a){return d.submitted||a.$dirty}}]).controller("mapInstanceCtrl",["$location","$scope","$log","$modalInstance",function(a,b,c,d){"use strict";!function(){b.ok=function(){d.close(b.selected.item)}}(),b.cancel=function(){d.dismiss("cancel")}}]).controller("mapErrorCtrl",["$location","$scope","$log","$modalInstance","error",function(a,b,c,d,e){"use strict";!function(){b.ok=function(){d.close(b.selected.item)}}(),b.errorMessage=e,b.cancel=function(){d.dismiss("cancel")}}]).controller("faqCtrl",["$location","$scope","$log","search",function(a,b,c,d){"use strict";!function(){b.open={first:!1,second:!1,third:!1}}()}]),angular.module("ELT.controllers").controller("addressOptionsCtrl",["$scope","search","$state","autoAddressAPIService",function(a,b,c,d){"use strict";b.searchType2="Options",function(){if(!b.result||!b.result.options)return void c.go("home");b.result.options&&(a.options=b.result.options),b.result.addressId&&b.result.options[0].addressId===b.result.addressId&&a.options.splice(0,1)}(),a.selectOption=function(a){d.searchNext(a.links[0].href)}}]).controller("groupOptionsCtrl",["$scope","$log","search","$state","groupItems","$sce","autoAddressAPIService",function(a,b,c,d,e,f,g){"use strict";c.searchType2="Options",function(){a.tab=c.optionTab?c.optionTab:1,a.groups=angular.copy(c.result.intelligentGroupAddresses),c.result.addressId&&c.result.intelligentGroupAddresses[0].addressId===c.result.addressId&&a.groups.splice(0,1),a.groupType=c.result.matchLevel.text}(),a.optionType=function(a){switch(a.optionType.text){case"GroupedNonBusiness":return"list";default:return"result"}},a.selectGroup=function(a,b){b?g.searchNext(a.links[0].href+"&limit=0"):g.searchNext(a.links[0].href)},a.selectAddress=function(a){g.ECADSearch(a.ecad_id,"options")}}]).controller("multiOptionsCtrl",["$scope","$log","search","$state","groupItems","$sce","autoAddressAPIService",function(a,b,c,d,e,f,g){"use strict";c.searchType2="Options",function(){if(!c.result||!c.result.options)return void d.go("home");a.groupType=c.result.matchLevel.text,a.tab=c.optionTab?c.optionTab:2,2===a.tab?c.result.intelligentGroup&&0!=c.result.intelligentGroup.length||(a.tab=1):1===a.tab&&(c.result.intelligentGroupAddresses&&0!=c.result.intelligentGroupAddresses.length||(a.tab=2)),a.groups=angular.copy(c.result.intelligentGroupAddresses),c.result.addressId&&c.result.intelligentGroupAddresses[0].addressId===c.result.addressId&&a.groups.splice(0,1),a.businessgroups=c.result.intelligentGroup,a.multipleBusinessGroups=!0,a.multipleAddressesGroups=!0,0===a.businessgroups.length&&(a.multipleBusinessGroups=!1),0===a.groups.length&&(a.multipleAddressesGroups=!1)}(),a.optionType=function(a){switch(a.optionType.text){case"GroupedNonBusiness":case"GroupedBusiness":return angular.isUndefinedOrNull(a.addressType)?"list":"result";default:return"result"}},a.selectGroup=function(a){g.searchNext(a.links[0].href)},a.selectAddress=function(a){g.searchNext(a.links[0].href)},a.selectTab=function(b){a.tab=b,c.optionTab=b},a.isSelected=function(b){return a.tab===b}}]).controller("multiGroupItemOptionsCtrl",["$scope","search","$state","groupItems","autoAddressAPIService",function(a,b,c,d,e){"use strict";b.searchType2="Options",function(){if(!(b.result&&b.result.intelligentGroup&&b.result.intelligentGroupAddresses&&b.result.intelligentGroupAddresses.length&&b.result.intelligentGroup))return void c.go("home");a.groupType=b.result.groupType,a.tab=b.optionTab?b.optionTab:2,a.groups=angular.copy(b.result.intelligentGroupAddresses),b.result.intelligentGroupAddresses[0].displayName===b.result.postalAddress.join(", ")&&a.groups.splice(0,1),a.businessgroups=b.result.intelligentGroup,a.multipleBusinessGroups=!0,a.multipleAddressesGroups=!0,0===a.businessgroups.length&&(a.multipleBusinessGroups=!1),0===a.groups.length&&(a.multipleAddressesGroups=!1)}(),a.selectAddress=function(a){e.searchNext(a.links[0].href)},a.selectTab=function(c){a.tab=c,b.optionTab=c},a.isSelected=function(b){return a.tab===b}}]).controller("groupItemOptionsCtrl",["$scope","search","$state","autoAddressAPIService",function(a,b,c,d){"use strict";b.searchType2="Options",function(){a.options=angular.copy(b.result.options),a&&a.options&&a.options[0]&&a.options[0].addressType&&a.options[0].addressType.code&&2210==a.options[0].addressType.code&&a.options.splice(0,1),a.groupType=b.result.matchLevel.text}(),a.selectOption=function(a){d.searchNext(a.links[0].href)}}]);var services=angular.module("ELT.services",["ELT.configuration"]).factory("autoAddressAPIService",["$sanitize","$http","WEBSERVICE_ENDPOINTS","$state","search","$log","cookieService","$translate","identity","previousSearch","$location",function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(a,b){if(0!=b&&!angular.isUndefinedOrNull(a.options[b].addressType))switch(a.options[b].addressType.code){case 2100:case 2220:case 2230:e.optionTab=1===e.optionTab?1:2;break;default:e.optionTab=2===e.optionTab?2:1}e.optionTab=1===e.optionTab&&a.intelligentGroupAddresses.length>1?1:2}var m={};return m.getLink=function(a){a&&-1===a.indexOf("geographicAddress")&&(a+="&geographicAddress=true");var c=getClientVersion();return ga("send","event","FinderClientVersion","autocomplete - "+c),a+="&clientVersion="+c,b.get(a)},m.getECAD=function(a,d,f){void 0===d&&(d="options"),void 0===f&&(f=!1);var g=getClientVersion();ga("send","event","FinderClientVersion","getecaddata - "+g);var j={ecad:a,txn:e.result.input.txn,language:"ie"===h.use()?"ga":h.use(),key:i.key,history:210==e.result.result.code},k="key="+j.key+"&addressId="+j.ecad+"&txn="+j.txn+"&history="+j.history+"&geographicAddress=true&clientVersion="+g;return e.searchType="ecad",e.ecadid=j.ecad,b.get(c.ECAD_LOOKUP_ENDPOINT+k)},m.getAddress=function(a){var d=getClientVersion();ga("send","event","FinderClientVersion","findaddress - "+d);var f=encodeURIComponent(a),g={address:f,language:"ie"===h.use()?"ga":h.use(),key:i.key},j="key="+g.key+"&address="+g.address+"&language="+g.language+"&geographicAddress=true&clientVersion="+d;return e.searchType="address",b.get(c.ADDRESS_LOOKUP_ENDPOINT+j)},m.getAutoComplete=function(a){var d=encodeURIComponent(a),e={address:d,language:"ie"===h.use()?"ga":h.use(),key:i.key},f="key="+e.key+"&address="+e.address+"&language="+e.language+"&geographicAddress=true";return b.get(c.AUTOCOMPLETE_ENDPOINT+f)},m.submitIssue=function(d,e){var f,g="";e.mapCenterCoords&&(g=e.mapCenterCoords.lat+","+e.mapCenterCoords.lon),f=e.result?[e.result.eircodeMatch,e.searchQuery,e.searchType,e.ecadid,g].join("~"):"No Search Performed";var h=d.notes.trim();h=h.replace(/[|:;$%@^"<>()*#}&]/g," "),"?"!==h[h.length-1]&&"."!==h[h.length-1]||(h=h.slice(0,-1));var j=(getClientVersion(),{name:encodeURIComponent(a(d.name)),email:encodeURIComponent(a(d.email)),issue:encodeURIComponent(d.issue),notes:encodeURIComponent(a(h)),supplementaryInfo:encodeURIComponent(f),callback:"JSON_CALLBACK",key:i.key}),k=j.name+"/"+j.email+"/"+j.issue+"\\/?notes="+j.notes+"&supplementaryInfo="+j.supplementaryInfo+"&callback="+j.callback+"&key="+j.key;return b.jsonp(c.REPORT_AN_ISSUE+k)},m.shareEircode=function(d){var e={name:encodeURIComponent(a(d.name)),myEmail:encodeURIComponent(a(d.email)),friendEmail:encodeURIComponent(a(d.friendEmail)),ecadId:encodeURIComponent(d.ecad_id),callback:"JSON_CALLBACK",key:i.key},f=e.name+"/"+e.myEmail+"/"+e.friendEmail+"/"+e.ecadId+"?callback="+e.callback+"&key="+e.key;return b.jsonp(c.SHARE_EIRCODE+f)},m.getIdentity=function(){return b.get(c.IDENTITY)},m.chooseSearch=function(a,b){switch(b){case"link":return m.getLink(a);case"ecad":return m.getECAD(a,"ac");default:return m.getAddress(a)}},m.isEircodeSearch=function(a){return m.isLikeEircodeSearch(a)&&7===a.replace(/\s+/g,"").length},m.isLikeEircodeSearch=function(a){return/^[a-zA-Z][0-9|W|w|s|S|O|o|I|i|L|l|Z|z|B|b|U|u]{2}/.test(a.toString().replace(/\s+/g,""))},m.isAutoCompleteLikeEircodeSearch=function(a){return/^[a-zA-Z][0-9|W|w]{2}/.test(a.toString().replace(/\s+/g,""))},m.ECADSearch=function(a,b,c){if(g.restrictSearches())return void d.go("home");m.getECAD(a,b,c).success(function(a){if(a.error)return void d.go("home");j.result.push(e.result),j.MultipleAddresses=null,j.searchQuery=null,j.selectedAddress=null,j.searchCompleted=!1,e.rememberSearch=!1,e.searchType=null,e.result=a,"multiple"===e.result.cardinalityLevel?e.MultipleAddresses=!0:e.MultipleAddresses=!1;var b=m.getAddressView(e.result,!1);""!==b&&(angular.equals(d.current.name,b)?d.go(d.current,{},{reload:!0}):d.go(b))}).error(function(){d.go("500")})},m.searchNext=function(a,b,c){if(b=angular.isUndefinedOrNull(b)?"link":b,g.restrictSearches())return void d.go("home");m.chooseSearch(a,b).success(function(a){if(a.error)return void d.go("home");"ecad"!==b&&(j.result.push(e.result),j.MultipleAddresses=null,j.searchQuery=null,j.selectedAddress=null,j.searchCompleted=!1),e.rememberSearch=!1,e.searchType=null,e.result=a,""!==(c=c||m.getAddressView(e.result,"ecad"!==b))&&(angular.equals(d.current.name,c)?d.go(d.current,{},{reload:!0}):d.go(c))}).error(function(){d.go("500")})},m.getAddressView=function(a,b){var c="";if(angular.isUndefinedOrNull(a.error)||($scope.restrictSearches=!0,d.go("home")),b)if(a.result&&(e.historic="PostcodeRetired"===a.result.text,e.changed="PostcodeAmended"===a.result.text),angular.isUndefinedOrNull(a.options)||angular.isUndefinedOrNull(a.options.length))switch(a.result.code){case 100:case 110:case 120:case 130:case 140:case 150:case 210:a.spatialInfo?c="result":(m.searchNext(a.addressId,"ecad","result"),c="");break;case 200:c="no-eircode";break;case 300:c="nua";break;case 400:case 500:case 550:default:c="partial"}else angular.isUndefinedOrNull(a.addressType)?(c="group-options",a.intelligentGroup=[],a.intelligentGroupAddresses=a.options.slice()):(a.intelligentGroup=a.options.filter(function(a){return"GroupedBusiness"===a.optionType.text}),a.intelligentGroupAddresses=a.options.filter(function(a){return"GroupedBusiness"!==a.optionType.text}),e.optionTab=0!==a.intelligentGroup.length?1:2,c="NonResidentialAddressPoint"===a.addressType.text||"ResidentialAddressPoint"===a.addressType.text?"group-item-options":"address-options",1===a.intelligentGroupAddresses.length&&1===a.intelligentGroup.length?(c="multi-group-item-options",e.optionTab=2):a.intelligentGroupAddresses.length>0&&a.intelligentGroup.length>0&&(c="multi-options",a.options.forEach(function(b,c){l(a,c)})));else c=a.eircodeInfo?"result":"";return c},m}]).factory("search",function(){"use strict";return{}}).factory("previousSearch",function(){"use strict";return{}}).factory("groupItems",function(){"use strict";return{}}).factory("searchOffset",function(){"use strict";return{}}).factory("identity",function(){"use strict";return{}}).factory("isEircode",["$q","$http","EIRCODE_LOOKUP_ENDPOINT",function(a,b,c){"use strict";return function(d){var e=a.defer(),f={eircode:d,callback:"JSON_CALLBACK"},g=f.eircode+"?callback="+f.callback;return b.jsonp(c+g).then(function(){e.resolve()},function(){e.reject()}),e.promise}}]).factory("etlLocate",["$q","$http","WEBSERVICE_ENDPOINTS","$translate","identity",function(a,b,c,d,e){"use strict";var f={};return f.getEircode=function(a,d,f){var g=getClientVersion();ga("send","event","FinderClientVersion","reversegeocode - "+g);var h={lat:a,lon:d,radius:f,key:e.key},i="key="+h.key+"&latitude="+h.lat+"&longitude="+h.lon+"&maxDistance="+h.radius+"&geographicAddress=true&clientVersion="+g;return b.get(c.ELTLOCATE_LOOKUP_ENDPOINT+i)},f}]).service("labelService",["$log",function(){"use strict";this.getOptionLabel=function(a,b){var c="";if("eircode"===b)c="OPTIONS_EIRCODE_SHARED";else switch(a.result.code){case 100:c="OPTIONS_ADDRESS_FOUND";break;case 300:case 500:c=angular.isUndefinedOrNull(a.options)?"OPTIONS_ADDRESS_MATCH":"OPTIONS_ADDRESS_FOUND";break;default:c="OPTIONS_ADDRESS_MATCH"}return c}}]);angular.module("ELT.services").service("cookieService",["$cookieProvider","identity","$log",function(a,b,c){"use strict";function d(a){return!isNaN(a)&&!(+a<0)}this.getSearchCount=function(){var b=a.get("EircodeFinder"),c=new Date,e=new Date(c.getFullYear(),c.getMonth(),c.getDate()+1,0,0,0);return angular.isDefined(b)?(d(b)||(b=0,a.put("EircodeFinder",0,{expires:e})),b):(a.put("EircodeFinder",0,{expires:e}),0)},this.searchCountRemaining=function(){return b.count-this.getSearchCount()},this.restrictSearches=function(){return this.searchCountRemaining()?this.searchCountRemaining()<=0:0===this.searchCountRemaining()},this.incrementSearchCount=function(){var b=a.get("EircodeFinder"),c=new Date,d=new Date(c.getFullYear(),c.getMonth(),c.getDate()+1,0,0,0);b||(b=0),b=parseInt(b)+1,a.put("EircodeFinder",b,{expires:d})}}]),angular.module("ELT.services").service("modalService",["$modal","$log",function(a,b){"use strict";this.mapErrorModal=function(b){a.open({templateUrl:"view/modal/mapError.html",controller:"mapErrorCtrl",windowClass:"app-modal-window",resolve:{error:function(){return b}}})},this.shareEircodeModal=function(b){a.open({templateUrl:"view/modal/shareEircode.html",controller:"shareEircodeCtrl",resolve:{result_id:function(){return b}}})},this.noEircodeFoundModal=function(){a.open({templateUrl:"view/modal/noEircodeFoundError.html",controller:"mapInstanceCtrl",windowClass:"app-modal-window"})},this.browserOutdatedModal=function(){a.open({templateUrl:"view/modal/browserOutdated.html",controller:"mapInstanceCtrl"})},this.showEircodeModal=function(b){a.open({templateUrl:"view/modal/showEircode.html",controller:"showEircodeCtrl",windowClass:"eircode-result",resolve:{result:function(){return b}}})}}]);var configuration=angular.module("ELT.configuration",[]).constant("WEBSERVICE_ENDPOINTS",function(){"use strict";var a="https://api-finder.eircode.ie/Latest/";return{EIRCODE_LOOKUP_ENDPOINT:a+"eircode/",ECAD_LOOKUP_ENDPOINT:a+"findergetecaddata?",ADDRESS_LOOKUP_ENDPOINT:a+"finderfindaddress?",AUTOCOMPLETE_ENDPOINT:a+"finderautocomplete?",ELTLOCATE_LOOKUP_ENDPOINT:a+"finderreversegeocode?",IDENTITY:a+"findergetidentity?",REPORT_AN_ISSUE:a+"email/help/",SHARE_EIRCODE:a+"email/share/",OSI_ENDPOINT:"https://mapgenie.osi.ie/",REDDOT_LAYER:"https://tiles.autoaddress.ie/Finder",MAP_GENIE_TOKEN:"AreAIun0gW1uKbbPSH-0JX4ZlPjlNKeZbysY-7f-S-brn79bIV965y6Bt3XOiA4CwzC6XyTSTCWE0-R6Rg_l9w..",REQUEST_CARD_KEY:"amtechamtech1234",REQUEST_CARD_URL:"https://www.eircode.ie/card/Card.aspx"}}()),directives=angular.module("ELT.directives",["ui.bootstrap.tooltip"]).directive("addressList",function(){"use strict";return{restrict:"E",scope:{address:"=",irish:"=",eircode:"=",historic:"=",changed:"=",isEnglish:"=",postalAddress:"="},templateUrl:"view/partials/addressTab.html",controller:AddressListController,controllerAs:"vm"}}).directive("uniqueEircode",["isEircode",function(a){"use strict";return{restrict:"A",require:"ngModel",link:function(b,c,d,e){e.$asyncValidators.unique=a}}}]).directive("validEircode",function(){"use strict";return{restrict:"AE",require:"ngModel",link:function(a,b,c,d){d.$validators.username=function(a,b){return/^[a-zA-Z0-9]+$/.test(a||b)}}}}).directive("focus",function(){"use strict";return function(a,b){b[0].focus()}}).directive("fadeOut",["$timeout",function(a){"use strict";return function(b,c){a(function(){angular.element(".pointing-code").delay(5e3).fadeOut()})}}]).directive("autoTranslate",["$interpolate","$compile","$timeout",function(a,b,c){"use strict";return function(a,d,e){c(function(){var c=d.html();d.html(c),b(d.contents())(a)})}}]).directive("openSupportModal",["$modal","$interpolate","$compile",function(a,b,c){"use strict";return{link:function(b,c){function d(){a.open({templateUrl:"view/modal/supportModalContent.html",controller:"supportInstanceCtrl"})}c.bind("click",d)}}}]).directive("sticky",["$timeout","$window","$compile","$rootScope",function(a,b,c,d){"use strict";return function(e,f,g){a(function(){function f(){var a=angular.element(".original").offset(),c=a.top;if($(window).scrollTop()>=c){if(b.innerWidth>767){var d=angular.element(".original"),e=d.offset(),f=e.left,g=d.css("width");angular.element(".cloned").css("left",f+"px").css("top",0).css("width",g).show(),angular.element(".original").css("visibility","hidden"),angular.element(".original").addClass("orginal-header")}}else angular.element(".cloned").hide(),angular.element(".original").css("visibility","visible"),angular.element(".original").removeClass("orginal-header")}angular.element(".header").addClass("original").clone().insertAfter(".header").addClass("cloned").css("position","fixed").css("top","0").css("margin-top","0").css("z-index","1005").css("padding-top","15px").css("padding-bottom","16px").removeClass("original").hide();var g=angular.element(".cloned");c(g.contents())(e),angular.element(b).bind("scroll",function(){a(function(){f()})}),d.$on("$viewContentLoaded",function(){a(function(){f()})})})}}]).directive("searchBar",["$window","$log","searchOffset",function(a,b,c){"use strict";return{link:function(b,d){function e(){a.innerWidth<=767&&(angular.element("html,body").animate({scrollTop:angular.element(".input-group").offset().top-5},500),c.top=!0)}d.bind("click",e)}}}]).directive("openQueryAddressModal",["$modal",function(a){"use strict";return{link:function(b,c){function d(){a.open({templateUrl:"view/modal/addressQueryResult.html",controller:"supportInstanceCtrl",windowClass:"address-format"})}c.bind("click",d)}}}]).directive("openQueryGeographicAddressModal",["$modal",function(a){"use strict";return{link:function(b,c){function d(){a.open({templateUrl:"view/modal/geographicAddressQueryResult.html",controller:"supportInstanceCtrl",windowClass:"address-format"})}c.bind("click",d)}}}]).directive("openChangedAddressModal",["$modal",function(a){"use strict";return{link:function(b,c){function d(){a.open({templateUrl:"view/modal/addressChangedResult.html",controller:"supportInstanceCtrl",windowClass:"address-format"})}c.bind("click",d)}}}]).directive("openExpiredAddressModal",["$modal",function(a){"use strict";return{link:function(b,c){function d(){a.open({templateUrl:"view/modal/addressExpiredResult.html",controller:"supportInstanceCtrl",windowClass:"address-format"})}c.bind("click",d)}}}]).directive("closeMapMessage",function(){"use strict";return function(a,b){var c=function(){angular.element(".map-error-msg, .map-overlay, .map-overlay-loading").fadeOut("slow")};b.bind("click",c)}}).directive("closePopover",function(){"use strict";return function(a,b){var c=function(){var a=this.tt_isOpen,b=document.querySelectorAll("[popover]");angular.forEach(b,function(a){angular.element(a).scope().tt_isOpen=!1}),this.tt_isOpen=a,b=document.querySelectorAll(".popover"),angular.forEach(b,function(a){angular.element(a).remove()})};b.bind("click",c)}}).directive("toggleFaq",["$timeout",function(a){"use strict";return function(b,c){var d=function(){a(function(){c.find(".panel-heading .panel-title").hasClass("actives")?c.find(".panel-heading .panel-title").removeClass("actives"):(angular.element(".panel-group").find(".panel-heading .panel-title").removeClass("actives"),c.find(".panel-heading .panel-title").addClass("actives"))})};c.bind("click",d)}}]).directive("tooltipDisplay",["$timeout",function(a){"use strict";return function(b,c,d){a(function(){angular.element(".my-popover").each(function(){var a=angular.element(this);a.popover({html:!0,placement:"bottom",container:angular.element("body"),content:angular.element("#content").html()}),a.on("shown.bs.popover",function(){var b=a.data("bs.popover");if(void 0!==b){var c=b.tip(),d=c.css("z-index");c.find(".close").bind("click",function(){b.hide()}),c.click(function(){b.hide()}),c.mouseover(function(){c.css("z-index",function(){return d+1})}).mouseout(function(){c.css("z-index",function(){return d})})}})})})}}]);AddressListController.$inject=["$scope","$window","WEBSERVICE_ENDPOINTS"],angular.module("ELT.directives").directive("optionLabel",["labelService","search","$log",function(a,b,c){"use strict";return{replace:!0,restrict:"AE",template:'<div class="error-msg col-xs-12 intelligent-group col-centered"><h1 translate>{{ optionLabel }}</h1></div>',link:function(c,d,e){b.result&&(c.optionLabel=a.getOptionLabel(b.result,b.searchType2))}}}]).directive("optionHeaderGrey",["search",function(a){"use strict";return{replace:!0,restrict:"AE",template:'<div class="clearfix inelligent-group-tabs"><ul class="dropdown-menu apartment-group"><li class="gr-aprtment apartment-list"><span class="gr-down-arrow pull-right"></span><div class="result-text ng-binding"><img src="images/map-pin.png"  class="map-pin" alt=""/>{{ buildingName }}</div> </li></ul></div>',link:function(b,c,d){b.buildingName=a.result.geographicAddress}}}]).directive("optionFoundAddressOptionsDisplay",["search",function(a){"use strict";return{replace:!0,restrict:"AE",template:'<li ng-show="display" class="gr-aprtment apartment-list"><span class="gr-down-arrow pull-right"></span><div class="result-text ng-binding"><img src="images/map-pin.png"  class="map-pin" alt=""/>{{ buildingName }}</div></li>',link:function(b,c,d){angular.isUndefinedOrNull(a.result.geographicAddress)?(b.buildingName=null,b.display=!1):(b.buildingName=a.result.geographicAddress.join(", "),b.display=!a.result.matchedNua&&a.result.geographicAddress&&400!==a.result.result.code)}}}]).directive("optionFoundAddressOptionsClickableDisplay",["search","$state",function(a,b){"use strict";return{replace:!0,restrict:"AE",template:'<li ng-show="nuaDisplay"><a href ng-click="searchEircodeMatch()"><span class="pull-right gr-map"></span><div class="result-text ng-binding"><img src="images/map-pin.png"  class="map-pin" alt=""/><strong>{{ buildingName }}</strong></div> </a></li>',link:function(b,c,d){b.buildingName=angular.isUndefinedOrNull(a.result.geographicAddress)?null:a.result.geographicAddress.join(", "),b.nuaDisplay="NonUniqueAddress"===a.result.result.text},controller:["$scope",function(a){a.searchEircodeMatch=function(){b.go("nua")}}]}}]).directive("optionFoundAddressDisplay",["search",function(a){"use strict";return{replace:!0,restrict:"AE",template:'<ul class="dropdown-menu apartment-group" ng-show="!barClickable"><li ng-show="buildingName" class="gr-aprtment apartment-list"><span class="gr-down-arrow pull-right"></span><div class="result-text ng-binding"><img src="images/map-pin.png"  class="map-pin" alt=""/>{{ buildingName }}</div></li></ul>',link:function(b,c,d){b.buildingName=a.result.geographicAddress.join(", "),b.barClickable="PostcodeAppended"===a.result.result.text||"NonUniqueAddress"===a.result.result.text}}}]).directive("optionFoundAddressClickableDisplay",["search","$state","autoAddressAPIService","cookieService",function(a,b,c,d){"use strict";return{replace:!0,restrict:"AE",template:'<ul class="dropdown-menu apartment-group" ng-show="barClickable"><li><a href ng-click="searchEircodeMatch()"><span class="pull-right" ng-class="nua ? \'gr-map\' : \'gr-arrow\'"></span><div class="result-text ng-binding"><img src="images/map-pin.png"  class="map-pin" alt=""/><strong>{{ buildingName }}</strong></div> </a></li></ul>',link:function(b,c,d){b.buildingName=a.result.geographicAddress.join(", "),b.barClickable="PostcodeAppended"===a.result.result.text||"NonUniqueAddress"===a.result.result.text,b.nua="NonUniqueAddress"===a.result.result.text},controller:["$scope",function(d){d.searchEircodeMatch=function(){"NonUniqueAddress"===a.result.result.text?b.go("nua"):c.searchNext(a.result.options[0].links[0].href)}}]}}]).directive("optionApartmentHeader",["search",function(a){"use strict";return{replace:!0,restrict:"AE",template:'<li class="gr-aprtment apartment-list"><span class="gr-down-arrow pull-right"></span><div class="result-text "><img class="gr-aprtment-icon" src="images/MultiResults-Apartment.png"  alt=""/> {{ buildingName }} </div> </li>',link:function(b,c,d){b.buildingName=a.result.geographicAddress.join(", ")}}}]).directive("optionMixedTabs",function(){"use strict";return{replace:!0,restrict:"AE",template:'<ul class="nav nav-tabs" role="tablist"><li class="view-by" translate="OPTIONS_VIEW_BY"></li><li ng-class="{active:isSelected(1)}"><a ng-click="selectTab(1)" id="residential-tab" ng-show="multipleAddressesGroups"><span class="residential pull-left"></span><span translate="OPTIONS_ADDRESS"></span></a></li><li ng-class="{active:isSelected(2)}"> <a ng-click="selectTab(2)" id="commercial-tab" ng-show="multipleBusinessGroups"><span class="commercial pull-left"></span><span translate="OPTIONS_BUSINESS"></span></a></li> </ul>'}}).directive("optionViewMap",function(){"use strict";return{replace:!0,restrict:"AE",template:'<p class="text-center view-on-map"><a ui-sref="map"><img src="images/View-on-map.png"  alt=""/>{{"VIEW_ON_MAP" | translate}}</a></p>'}});var directives=angular.module("ELT.filters",[]).filter("eircode",function(){"use strict";return function(a){return a?a.substring(0,3)+" "+a.substring(3,7):a}}).filter("addComma",function(){"use strict";return function(a){return a?a.toString().replace(/,/g,", "):a}}).filter("newLine",["$sce",function(a){"use strict";return function(b){return b?a.trustAsHtml(b.toString().replace(/,/g,",</br>")):b}}]).filter("displayGroupName",["$log","$sce",function(a,b){"use strict";return function(a){var c=" in ",d=a.toLowerCase().indexOf(c);if(d>=0){var e=d+c.length,f=a.substr(e);a=a?a.replace(f,"<strong>"+f+"</strong>"):a}return b.trustAsHtml(a)}}]).filter("highlightBuildingNumbers",["$log","$sce",function(a,b){"use strict";return function(a){var c="apartment",d=a.toLowerCase().indexOf(c);if(d>=0){var e=d+c.length,f=a.substr(e);a=a?a.replace(f,"<strong>"+f+"</strong>"):a}else a=a?a.replace(a,"<strong>"+a+"</strong>"):a;return b.trustAsHtml(a)}}]).filter("highlightFirstLine",["$log","$sce",function(a,b){"use strict";return function(a){var c=a.split(",");return c[0]=c[0]?c[0].replace(c[0],"<strong>"+c[0]+"</strong>"):c[0],c=c.join(", ").toString(),b.trustAsHtml(c)}}]).filter("highlightFirstLineAddress",["$log","$sce","$translate",function(a,b,c){"use strict";return function(a){var d="en"===c.use()?a.displayName.split(","):a.irishAddressLines;return"GroupedBusiness"===a.optionType.text?b.trustAsHtml((d||[]).join(", ").replace(d[0],"<strong>"+d[0]+"</strong>")):(d||[]).join(", ")}}]).filter("displayBuildingName",["$log",function(a){"use strict";return function(a){var b=a.split(",");return b.shift(),b=b.join(", ").toString()}}]).filter("displayBuildingNumber",["$log",function(a){"use strict";return function(a){return a.split(",").shift()}}]).filter("joinBy",function(){"use strict";return function(a,b){return(a||[]).join(b||", ")}}),providers=angular.module("ELT.providers",[]).provider("$cookieProvider",[function(){"use strict";var a=this;a.defaultOptions={},a.setDefaultOptions=function(b){a.defaultOptions=b},a.$get=function(){return{get:function(a){var b=$.cookie(a);if(b)return angular.fromJson(b)},put:function(b,c,d){d=$.extend({},a.defaultOptions,d),$.cookie(b,angular.toJson(c),d)},remove:function(b,c){c=$.extend({},a.defaultOptions,c),$.removeCookie(b,c)}}}}]);